<%
/**
 * Person Schema Markup
 * JSON-LD structured data pentru membrii echipei
 *
 * Variables required:
 * - person: Obiect cu datele persoanei (name, jobTitle, bio, etc.)
 */

if (typeof person === 'undefined' || !person) {
  // Skip rendering if no person data
  return;
}

const baseUrl = settings?.siteUrl || 'https://casa-ignat.ro';
const personUrl = person.url || `${baseUrl}/echipa/${person.slug}`;
const personImage = person.photo || `${baseUrl}/images/team-default.jpg`;
const personName = person.name;
const personJobTitle = person.position || 'NutriÈ›ionist';
const personBio = person.bio || '';

// Contact info
const personEmail = person.email || '';
const personPhone = person.phone || '';

// Social media
const socialLinks = person.socialLinks || {};
const sameAs = [
  socialLinks.facebook,
  socialLinks.instagram,
  socialLinks.linkedin,
  socialLinks.twitter,
  socialLinks.website
].filter(Boolean);

// Credentials and specializations
const credentials = person.credentials || [];
const specializations = person.specializations || [];

const schema = {
  '@context': 'https://schema.org',
  '@type': 'Person',
  '@id': `${personUrl}#person`,
  name: personName,
  jobTitle: personJobTitle,
  description: personBio,
  image: {
    '@type': 'ImageObject',
    url: personImage
  },
  url: personUrl,

  // Organization
  worksFor: {
    '@type': 'Organization',
    '@id': `${baseUrl}#organization`,
    name: 'Casa Ignat'
  },

  // Specializations
  knowsAbout: specializations
};

// Add contact info if available
if (personEmail) {
  schema.email = personEmail;
}
if (personPhone) {
  schema.telephone = personPhone;
}

// Add social media if available
if (sameAs.length > 0) {
  schema.sameAs = sameAs;
}

// Add credentials if available
if (credentials.length > 0) {
  schema.hasCredential = credentials.map(cred => ({
    '@type': 'EducationalOccupationalCredential',
    credentialCategory: 'degree',
    name: cred
  }));
}

// Add SEO meta if available
if (person.seo?.metaDescription) {
  schema.description = person.seo.metaDescription;
}
%>

<script type="application/ld+json">
<%- JSON.stringify(schema, null, 0) %>
</script>
